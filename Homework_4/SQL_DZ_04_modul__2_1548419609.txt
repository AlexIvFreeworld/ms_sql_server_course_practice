Курс:
Microsoft SQL Server
Модуль: Триггеры, хранимые процедуры и пользова-
тельские функции
Тема: Пользовательские функции
Обращаем ваше внимание, что при именовании баз дан-
ных, таблиц, столбцов и других объектов необходимо при-
держиваться рекомендаций по именованию объектов в базах
данных. Наименования объектов в заданиях даны только для
объяснения поставленной задачи.

Задание 1. Для базы данных «Спортивный магазин» из
практического задания модуля «Триггеры, хранимые про-
цедуры и пользовательские функции» создайте следующие
пользовательские функции:
1. Пользовательская функция возвращает количество уни-
кальных покупателей
2. Пользовательская функция возвращает среднюю цену то-
вара конкретного вида. Вид товара передаётся в качестве
параметра. Например, среднюю цену обуви
3. Пользовательская функция возвращает среднюю цену
продажи по каждой дате, когда осуществлялись продажи
4. Пользовательская функция возвращает информацию о по-
следнем проданном товаре. Критерий определения послед-
него проданного товара: дата продажи
5. Пользовательская функция возвращает информацию о пер-
вом проданном товаре. Критерий определения первого
проданного товара: дата продажи
6. Пользовательская функция возвращает информацию о за-
данном виде товаров конкретного производителя. Вид
товара и название производителя передаются в качестве
параметров
7. Пользовательская функция возвращает информацию о по-
купателях, которым в этом году исполнится 45 лет

Задание 2. Для базы данных «Музыкальная коллекция» из
практического задания модуля «Работа с таблицами и пред-
ставлениями в MS SQL Server» создайте следующие пользо-
вательские функции:
1. Пользовательская функция возвращает все диски заданного
года. Год передаётся в качестве параметра
2. Пользовательская функция возвращает информацию
о дисках с одинаковым названием альбома, но разными
исполнителями
3. Пользовательская функция возвращает информацию о всех
песнях в чьем названии встречается заданное слово. Слово
передаётся в качестве параметра
4. Пользовательская функция возвращает количество аль-
бомов в стилях hard rock и heavy metal
5. Пользовательская функция возвращает информацию о сред-
ней длительности песни заданного исполнителя. Название
исполнителя передаётся в качестве параметра
6. Пользовательская функция возвращает информацию о са-
мой долгой и самой короткой песне
7. Пользовательская функция возвращает информацию об
исполнителях, которые создали альбомы в двух и более
стилях.
