Курс:
Microsoft SQL Server
Модуль: Триггеры, хранимые процедуры и пользова-
тельские функции
Тема: Финальное практическое задание по модулю
Обращаем ваше внимание, что при именовании баз дан-
ных, таблиц, столбцов и других объектов необходимо при-
держиваться рекомендаций по именованию объектов в базах
данных. Наименования объектов в заданиях даны только для
объяснения поставленной задачи.

Задание 1. Используя триггеры, пользовательские функ-
ции, хранимые процедуры реализуйте следующую функци-
ональность:
1. Вернуть информацию о барбере, который работает в бар-
бершопе дольше всех
2. Вернуть информацию о барбере, который обслужил мак-
симальное количество клиентов в указанном диапазоне
дат. Даты передаются в качестве параметра
3. Вернуть информацию о клиенте, который посетил барбер-
шоп максимальное количество раз
4. Вернуть информацию о клиенте, который потратил в бар-
бершопе максимальное количество денег
5. Вернуть информацию о самой длинной по времени услуге
в барбершопе

Задание 2. Используя триггеры, пользовательские функ-
ции, хранимые процедуры реализуйте следующую функци-
ональность:
1. Вернуть информацию о самом популярном барбере (по
количеству клиентов)
2. Вернуть топ-3 барберов за месяц (по сумме денег, потра-
ченной клиентами)
3. Вернуть топ-3 барберов за всё время (по средней оценке).
Количество посещений клиентов не меньше 30
4. Показать расписание на день конкретного барбера. Ин-
формация о барбере и дне передаётся в качестве параметра
5. Показать свободные временные слоты на неделю конкрет-
ного барбера. Информация о барбере и дне передаётся
в качестве параметра
6. Перенести в архив информацию о всех уже завершенных
услугах (это те услуги, которые произошли в прошлом)
7. Запретить записывать клиента к барберу на уже занятое
время и дату
8. Запретить добавление нового джуниор-барбера, если в са-
лоне уже работают 5 джуниор-барберов
9. Вернуть информацию о клиентах, которые не поставили
ни одного фидбека и ни одной оценки
10. Вернуть информацию о клиентах, которые не посещали
барбершоп свыше одного года
